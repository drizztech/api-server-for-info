id: xss-angular-vue-template
info:
  name: Client-Side Template Injection (Angular/Vue)
  author: WhiteFatalis
  severity: high
  description: Detects client-side template injection for Angular and Vue.js frameworks.
  tags: xss, csti, angular, vue

http:
  - method: GET
    path:
      - "{{BaseURL}}/?q={{7*7}}"
      - "{{BaseURL}}/?q={{{7*7}}}"
      - "{{BaseURL}}/?search={{constructor.constructor('alert(1)')()}}"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "49"
          - "alert(1)"
        condition: or

      # Ensure it's not just reflecting the input but executing (hard to check execution with static matchers, but '49' indicates execution of {{7*7}})
      - type: word
        part: body
        words:
          - "ng-app"
          - "vue"
          - "v-app"
        condition: or
